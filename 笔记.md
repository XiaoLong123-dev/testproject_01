# Git分布式版本控制系统

### Git 概述

* 工作区(写代码) ----->git add ----> 暂存区(临时存储) ----> git commit ---->本地库(历史版本)---->git push ----> 远程库

### git和代码托管中心(远程库)

* 局域网
  * GitLab
* 互联网
  * GitHub
  * Gitee

### Linux命令

* 产看文件内容
  * cat 文件名
* 进入文件编辑状态
  * vim 文件名      + i        进入编辑状态
  * esc 退出编辑模式     :wq   保存文件
  * 

### Git的常用命令

* 设置用户签名
  * git config --global user.name 用户名
  * git config --global user.email 邮箱
* 初始化本地库
  * git init
* 查看本地库状态
  * git status
* 添加到缓存区
  * git add 文件名
  * git add .     添加全部文件
  * 删除暂存区的历史版本
    * git rm --cached <file>
* 提交到本地库
  * git commit -m "日志信息" 文件名
  * git commit -am 'xxx'           相当于git add . 加上 git commit -m 'xxx'
* 查看历史记录
  * git reflog	查看版本信息
  * git log      查看版本详细信息
* 版本穿梭
  * git reset --hard 版本号
  * 版本切换，底层就是移动的HEAD指针：head(指针)--->master(分支)---->first(版本)

### Git分支操作

* 创建分支

  * git branch 分支名
* 查看分支
  * git branch -v


  * 切换分支

    * git checkout 分支名
  * 把指定的分支合并到当前分支上

    * git merge 分支名
  * 删除本地分支

    * git branch -d 分支名

* 删除远程分支(相当于把一个空分支覆盖远程的分支)
  * git push origin(别名) :分支名

### Git冲突

* 合并分支时，两个分支在**同一个文件**有两套完全不同的修改，Git无法替我们决定使用哪一个，必须人为决定。
* 以下表示出现冲突
  * ![image-20221130190805609](C:\Users\LiuXiaoLong\AppData\Roaming\Typora\typora-user-images\image-20221130190805609.png)

* 解决方法：手动找到冲突的位置进行修改
  * 解决前
    * ![image-20221130190953187](C:\Users\LiuXiaoLong\AppData\Roaming\Typora\typora-user-images\image-20221130190953187.png)
  * 解决后
    * ![image-20221130191124169](C:\Users\LiuXiaoLong\AppData\Roaming\Typora\typora-user-images\image-20221130191124169.png)
  * 再次提交时不需要加文件名
    * ``$ git commit -m "merge test" hello.txt
      fatal: cannot do a partial commit during a merge.``
    * ``$ git commit -m "merge test"``
  * 注意：hot-fix分支内容不会发生改变

### GitHub

* 远程库操作

  * 查看当前远程库别名
    * git remote -v
    
  * 起别名
    * git remote add 别名 远程地址
    
  * 推送本地分支上的内容到远程仓库
    * git push 别名 分支
    
  * 将远程仓库的内容克隆到本地
    * git clone 远程地址
    
  * 将远程仓库对于分支最新内容拉下来后与当前本地分支直接合并
    * git pull 远程仓库别名 远程分支名

  * 删除库

    * git remote rm 库名
  
  * 如果远程新建了一个分支，本地没有该分支，origin也可以是仓库别名；branch_name与远程仓库相同的分支名。
  
    * ```
      git checkout --track origin/branch_name
      git pull origin branch_name
      ```

### GitLab

 

### 忽略文件

* .ignore

  * 在.git文件中的config文件中进行配置

  * ````
    [core]
    	excludesfile=忽略文件的路径

### 遇到的一些问题

* fatal: refusing to merge unrelated histories

  > 在合并分支时遇到
  >
  > 这是因为两个分支没有取得关系

  * 解决：在你操作命令后面加`--allow-unrelated-histories`

* 提交分支时：Everything up-to-date

  * ```
    接下来先创建一个新分支提交改动
    $ git branch newbranch
    
    然后输入这条命令检查是否创建成功
    $ git branch
    
    这时终端输出
     newbranch
    \* master
    
    这样就创建成功了，前面的*代表的是当前你所在的工作分支。我们接下来就要切换工作分支。
    $ git checkout newbranch
    
    这样就切换完了，可以 $ git branch 确认下。然后你要将你的改动提交到新的分支上。
    $ git add .
    $ git commit -a
    
    此时可以 $ git status 检查下提交情况。如果提交成功，我们接下来就要回主分支了，代码和之前一样。
    $ git checkout master
    
    然后我们要将新分支提交的改动合并到主分支上
    $ git merge newbranch
    
    合并分支可能产生冲突这是正常的，虽然我们这是新建的分支不会产生冲突，但还是在这里记录下。下面的代码可以查看产生冲突的文件，然后做对应的修改再提交一次就可以了。
    $ git diff
    
    我们的问题就解决了，接下来就可以push代码了。
    $ git push -u origin master
    
    新建分支的朋友别忘了删除这个分支
    $ git branch -D newbranch
    ```

* git pull与git clone
  * 两个都可以获取远程仓库的内容，但是如果没有权限就可以使用git clone
  
  * git clone 会拉取代码，初始化本地仓库，创建别名(origin)，并且不需要登陆